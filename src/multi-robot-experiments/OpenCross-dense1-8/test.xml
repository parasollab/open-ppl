<?xml version='1.0' encoding='UTF-8'?>
<MotionPlanning warnings="true" warningsAsErrors="true" print="false">

  <!-- Here we specify input files, such as environment and query. The
       'baseFilename in the Problem node is for Simulator stat output only. -->
  <Problem baseFilename="example">

    <Environment filename="../envs/OpenCross-dense1-8/3d.xml" positionRes="0.1" orientationRes="0.1"/>

    <Robot label="robot1" filename="../envs/OpenCross-dense1-8/iCreate.xml">
      <Agent type="planning"/>
    </Robot>
    <Robot label="robot2" filename="../envs/OpenCross-dense1-8/iCreate.xml">
      <Agent type="planning"/>
    </Robot>
    <Robot label="robot3" filename="../envs/OpenCross-dense1-8/iCreate.xml">
      <Agent type="planning"/>
    </Robot>
    <Robot label="robot4" filename="../envs/OpenCross-dense1-8/iCreate.xml">
      <Agent type="planning"/>
    </Robot> 
    <Robot label="robot5" filename="../envs/OpenCross-dense1-8/iCreate.xml">
      <Agent type="planning"/>
    </Robot>
    <Robot label="robot6" filename="../envs/OpenCross-dense1-8/iCreate.xml">
      <Agent type="planning"/>
    </Robot>
    <Robot label="robot7" filename="../envs/OpenCross-dense1-8/iCreate.xml">
      <Agent type="planning"/>
    </Robot>
    <Robot label="robot8" filename="../envs/OpenCross-dense1-8/iCreate.xml">
      <Agent type="planning"/>
    </Robot>        

    <RobotGroup label="robotGroup" robotLabels="robot1 robot2 robot3 robot4 robot5 robot6 robot7 robot8"/>


	<GroupTask label="groupQuery" group="robotGroup">
    <Task label="query-1" robot="robot1">
      <StartConstraints>
        <CSpaceConstraint point="-5.7  4.0  0.0"/>
            </StartConstraints>
      <GoalConstraints>
        <CSpaceConstraint point=" 5.7  3.2  0.0"/>
      </GoalConstraints>
    </Task>
    <Task label="query-2" robot="robot2">
      <StartConstraints>
        <CSpaceConstraint point="-5.7  1.6  0.0"/>
            </StartConstraints>
      <GoalConstraints>
        <CSpaceConstraint point=" 5.7  0.8  0.0"/>
      </GoalConstraints>
    </Task>
    <Task label="query-3" robot="robot3">
      <StartConstraints>
        <CSpaceConstraint point="-5.7  -0.8  0.0"/>
            </StartConstraints>
      <GoalConstraints>
        <CSpaceConstraint point="5.7  -1.6  0.0"/>
      </GoalConstraints>
    </Task>
    <Task label="query-4" robot="robot4">
      <StartConstraints>
        <CSpaceConstraint point="-5.7  -3.2  0.0"/>
            </StartConstraints>
      <GoalConstraints>
        <CSpaceConstraint point=" 5.7  -4.0  0.0"/>
      </GoalConstraints>
    </Task> 
    <Task label="query-5" robot="robot5">
      <StartConstraints>
        <CSpaceConstraint point=" 5.7  4.0  0.0"/>
            </StartConstraints>
      <GoalConstraints>
        <CSpaceConstraint point="-5.7  3.2  0.0"/>
      </GoalConstraints>
    </Task>
    <Task label="query-6" robot="robot6">
      <StartConstraints>
        <CSpaceConstraint point=" 5.7  1.6  0.0"/>
            </StartConstraints>
      <GoalConstraints>
        <CSpaceConstraint point="-5.7  0.8  0.0"/>
      </GoalConstraints>
    </Task>
    <Task label="query-7" robot="robot7">
      <StartConstraints>
        <CSpaceConstraint point=" 5.7  -0.8  0.0"/>
            </StartConstraints>
      <GoalConstraints>
        <CSpaceConstraint point="-5.7  -1.6  0.0"/>
      </GoalConstraints>
    </Task>
    <Task label="query-8" robot="robot8">
      <StartConstraints>
        <CSpaceConstraint point=" 5.7  -3.2  0.0"/>
            </StartConstraints>
      <GoalConstraints>
        <CSpaceConstraint point="-5.7  -4.0  0.0"/>
      </GoalConstraints>
    </Task>      
 	</GroupTask>

  </Problem>

  <!-- Set available algorithms and parameters. -->
  <Library>

    <Metrics>
      <NumNodesMetric label="NumNodes"/>
    </Metrics>

    <DistanceMetrics>
      <Minkowski label="minkowski" r1="3.0" r2="3.0" r3="0.333" normalize="false" />
      <Euclidean label="euclidean"/>
    </DistanceMetrics>

    <ValidityCheckers>
      <CollisionDetection label="pqp_solid" method="PQP_SOLID" interRobotCollision="false" debug="false" ignoreAdjacentLinks="true"/>
      <LocalBoundaryValidity label="local"/>
      <ComposeValidity label="compose" operator="and">
        <ValidityChecker label="local"/>
        <ValidityChecker label="pqp_solid"/>
      </ComposeValidity>
    </ValidityCheckers>

    <NeighborhoodFinders>
      <BruteForceNF label="BFNF" dmLabel="euclidean" unconnected="false" k="5"/>
      <BruteForceNF label="BFNF2" dmLabel="euclidean" unconnected="false" k="5"/>
      <BruteForceNF label="BFNF3" dmLabel="euclidean" unconnected="false" k="3"/>
      <BruteForceNF label="BFNF4" dmLabel="euclidean" unconnected="false" k="3"/>
      <BruteForceNF label="Nearest" dmLabel="minkowski" unconnected="false" k="1" />
    </NeighborhoodFinders>

    <Samplers>
      <UniformRandomSampler label="UniformRandom" vcLabel="pqp_solid"/>
      <UniformRandomSampler label="UniformRandomFree" vcLabel="pqp_solid"
        debug="false"/>
      <UniformRandomSampler label="UniformRandomFree-LocalRepair" vcLabel="compose"/>
      <ObstacleBasedSampler label="OBPRM" vcLabel="pqp_solid" useBBX="false"
        pointSelection="cspace" dmLabel="euclidean" stepSize="0.0"
        nShellsColl="0" nShellsFree="1" debug="false"/>
    </Samplers>

    <LocalPlanners>
      <StraightLine label="sl" binaryEvaluation="false" vcLabel="pqp_solid"
        saveIntermediates="true"/>
      <StraightLine label="slAlwaysTrue" binaryEvaluation="true"
        vcLabel="alwaysTrue"/>
    </LocalPlanners>

    <Extenders>
      <BasicExtender label="BERO" debug="false" dmLabel="euclidean"
        vcLabel="pqp_solid" maxDist="1." minDist=".001"/>
    </Extenders>

    <PathModifiers>
    </PathModifiers>

    <Connectors>
      <NeighborhoodConnector label="Closest" nfLabel="BFNF" lpLabel="sl"
        checkIfSameCC="false" debug="false"/>
      <NeighborhoodConnector label="Closest2" nfLabel="BFNF2" lpLabel="sl"
        checkIfSameCC="false" debug="false"/>
      <NeighborhoodConnector label="Closest3" nfLabel="BFNF3" lpLabel="sl"
        checkIfSameCC="false" debug="false"/>
      <NeighborhoodConnector label="Closest4" nfLabel="BFNF4" lpLabel="sl"
        checkIfSameCC="false" debug="false"/>
    </Connectors>

    <MapEvaluators>
      <TrueEvaluation label="AlwaysTrue"/>
      <IterationCountEvaluator label="IterationEval" minCount="2"/>
      <IterationCountEvaluator label="IterationEval2" minCount="1"/>
      <TimeEvaluator label="TimeEval" timeout="1000"/>

      <ConditionalEvaluator label="NodesEval" metric_method="NumNodes"
        value="16" operator=">="/>

      <QueryMethod label="IndividualQuery" debug="false"
        safeIntervalToolLabel="SI"/>

      <GroupQuery label="CompositeQuery" debug="false"/>

      <GroupDecoupledQuery label="DecoupledQuery" queryLabel="SIPP"
        debug="true" vcLabel="pqp_solid" ignoreOtherRobots="false"/>

      <GroupDecoupledQuery label="DecoupledQuery-local" queryLabel="SIPP"
        debug="false" vcLabel="pqp_solid" ifLocal="false" ignoreOtherRobots="false"/>

      <CBSQuery label="CBSQuery" queryLabel="SIPP" debug="true" vcLabel="pqp_solid"
        alpha="0.1" X="0.999"/>

      <LocalRepairQuery label="RepairQuery-LocalRepair1" queryLabel="IndividualQuery"
        debug="false" vcLabel="pqp_solid" repairStrategyLabel="localRepair1" />

      <LocalRepairQuery label="RepairQuery-LocalRepair2" queryLabel="IndividualQuery"
        debug="true" vcLabel="pqp_solid" repairStrategyLabel="localRepair2" />

      <LocalRepairQuery label="RepairQuery-LocalRepair3" queryLabel="IndividualQuery"
        debug="false" vcLabel="pqp_solid" repairStrategyLabel="localRepair3" />       
        
      <ARCQuery label="ARCQuery" debug="true" vcLabel="pqp_solid" arcStrategyLabel="arc"/>              

      <!--ValidityProbabilisticEvaluator label="ProbEval" vcLabel="pqp_solid"
        discount="0.5"/-->

      <ComposeEvaluator label="BoundedIndividualQuery" operator="or">
        <Evaluator label="TimeEval"/>
        <Evaluator label="IndividualQuery"/>
      </ComposeEvaluator>

      <ComposeEvaluator label="BoundedCompositeQuery" operator="or">
        <Evaluator label="CompositeQuery"/>
        <Evaluator label="IterationEval2"/>
      </ComposeEvaluator>

      <ComposeEvaluator label="BoundedDecoupledQuery-local" operator="or">
        <Evaluator label="DecoupledQuery-local"/>
        <Evaluator label="IterationEval2"/>
      </ComposeEvaluator>

      <!-- <ComposeEvaluator label="BoundedRepairQuery-LocalRepair" operator="or">
        <Evaluator label="TimeEval"/>
        <Evaluator label="RepairQuery-LocalRepair"/>
      </ComposeEvaluator> -->

      <!--ComposeEvaluator label="BoundedQuery" operator="or">
          <Evaluator label="TimeEval"/>
          <Evaluator label="IndividualQuery"/>
      </ComposeEvaluator-->

      <SIPPMethod label="SIPP" safeIntervalToolLabel="SI"/>
    </MapEvaluators>


    <MPStrategies>

     <!-- BasicPRM -->
      <BasicPRM label="SharedRoadmapPRM" debug="false">
        <Sampler label="UniformRandomFree" number="1" attempts="5"/>
        <Connector label="Closest"/>
        <Evaluator label="NodesEval"/>
      </BasicPRM>
      <BasicPRM label="IndividualEvaluation" debug="false" querySampler="UniformRandomFree">
        <Connector label="Closest"/>
        <Evaluator label="AlwaysTrue"/>
      </BasicPRM>

      <!-- BasicPRM -->
      <BasicPRM label="IndividualPRM2" debug="false">
        <Sampler label="UniformRandomFree" number="10" attempts="5"/>
        <Connector label="Closest2"/>
        <Evaluator label="BoundedIndividualQuery"/>
      </BasicPRM>

      <!-- BasicPRM -->
      <BasicPRM label="IndividualPRM4" debug="false">
        <Sampler label="UniformRandomFree" number="5" attempts="5"/>
        <Connector label="Closest4"/>
        <Evaluator label="BoundedIndividualQuery"/>
      </BasicPRM>

      <!-- Basic RRT -->
      <!--BasicRRTStrategy label="RRT" debug="false"
        samplerLabel="UniformRandomFree"
        nfLabel="Nearest" extenderLabel="BERO"
        growGoals="false" growthFocus="0.01" m="1"
        goalDmLabel="euclidean" goalThreshold="5">
        <Evaluator label="Query"/>
      </BasicRRTStrategy-->

      <!-- OBPRM -->
      <!--BasicPRM label="OBPRM" debug="false" querySampler="UniformRandomFree">
        <Sampler label="OBPRM" number="10" attempts="5"/>
        <Connector label="Closest"/>
        <Evaluator label="BoundedIndividualQuery"/>
      </BasicPRM-->

      <!-- CBSPRM -->
      <GroupDecoupledStrategy label="CBSPRM" debug="true"
        strategyLabel="IndividualPRM2"
        writeOutput="true" ifSharedRoadmap="false" >
        <Evaluator label="CBSQuery"/>
      </GroupDecoupledStrategy>

      <!-- CBSPRM-local -->
      <EvaluateMapStrategy label="CBSPRM-local">
        <Evaluator label="CBSQuery"/>
      </EvaluateMapStrategy>

      <!-- CBSRRT -->
      <GroupDecoupledStrategy label="CBSRRT" strategyLabel="RRT"
        writeOutput="true" >
        <Evaluator label="CBSQuery"/>
      </GroupDecoupledStrategy>

      <!-- CompositePRM-local -->
      <GroupPRM label="CompositePRM-local" debug="false">
        <Sampler label="UniformRandomFree" number="5" attempts="5"/>
        <Connector label="Closest3"/>
        <Evaluator label="BoundedCompositeQuery"/>
      </GroupPRM>

      <!-- CompositePRM -->
      <GroupPRM label="CompositePRM" debug="false">
        <Sampler label="UniformRandomFree" number="5" attempts="5"/>
        <Connector label="Closest3"/>
        <Evaluator label="CompositeQuery"/>
      </GroupPRM>

      <!-- DRRRT -->
      <!--DynamicRegionRRT label="DRRRT" debug="false" querySampler="UniformRandomFree"
          samplerLabel="UniformRandom" nfLabel="Nearest" extenderLabel="BERO"
          growGoals="true" connectorLabel="Closest" explore=".2" regionFactor="2.5"
          penetration="1" velocityBiasing="false" velocityAlignment=".4"
          decompositionLabel="fine" skeletonType="ma">
          <Evaluator label="BoundedQuery" />
      </DynamicRegionRRT-->

      <!-- RepairOBPRM-LocalRepair -->
      <!--GroupDecoupledStrategy label="RepairOBPRM-LocalRepair" strategyLabel="OBPRM"
        writeOutput="true" >
        <Evaluator label="RepairQuery-LocalRepair1"/>
      </GroupDecoupledStrategy-->

      <!-- RepairPRM-LocalRepair1 -->
      <GroupDecoupledStrategy label="RepairPRM-LocalRepair1"
        strategyLabel="IndividualPRM2" srStrategyLabel="SharedRoadmapPRM"
        writeOutput="true" ifSharedRoadmap="false" >
        <Evaluator label="RepairQuery-LocalRepair1"/>
      </GroupDecoupledStrategy>

      <!-- RepairPRM-LocalRepair1 -->
      <GroupDecoupledStrategy label="RepairPRM-LocalRepair2"
        strategyLabel="IndividualEvaluation" srStrategyLabel="SharedRoadmapPRM"
        writeOutput="true" ifSharedRoadmap="true" >
        <Evaluator label="RepairQuery-LocalRepair2"/>
      </GroupDecoupledStrategy>

      <!-- RepairPRM-LocalRepair1 -->
      <GroupDecoupledStrategy label="RepairPRM-LocalRepair3"
        strategyLabel="IndividualEvaluation" srStrategyLabel="SharedRoadmapPRM"
        writeOutput="true" ifSharedRoadmap="true" >
        <Evaluator label="RepairQuery-LocalRepair3"/>
      </GroupDecoupledStrategy>            

      <!-- ARC Strategy -->
      <!-- <GroupHybridStrategy label="ARCStrategy"
        strategyLabel="IndividualEvaluation" srStrategyLabel="SharedRoadmapPRM"
        writeOutput="true" ifSharedRoadmap="true" >
        <Evaluator label="ARCQuery"/>
      </GroupHybridStrategy>         -->

      <!-- DecoupledPRM -->
      <GroupDecoupledStrategy label="DecoupledPRM"
        strategyLabel="IndividualEvaluation" srStrategyLabel="SharedRoadmapPRM"
        writeOutput="true" debug="true" ifSharedRoadmap="true">
        <Evaluator label="DecoupledQuery"/>
      </GroupDecoupledStrategy>

      <!-- DecoupledPRM-local -->
      <GroupDecoupledStrategy label="DecoupledPRM-local"
        strategyLabel="IndividualPRM2"
        writeOutput="true" debug="false">
        <Evaluator label="BoundedDecoupledQuery-local"/>
      </GroupDecoupledStrategy>

      <!-- DecoupledPRM-local2 -->
      <GroupDecoupledStrategy label="DecoupledPRM-local2"
        strategyLabel="IndividualPRM4"
        writeOutput="true" debug="false">
        <Evaluator label="BoundedDecoupledQuery-local"/>
      </GroupDecoupledStrategy>

      <ARCStrategy label="ARC" windowSize="10" increment="2"
        radius="1.1" queryLabel="IndividualQuery" 
        strategyLabel="IndividualPRM2" debug="true" vcLabel="local" behavior=""
        ifExpandRobot="false" iterationEval="IterationEval2" ifHierarchical="true">
        <Evaluator label="ARCQuery"/>
        <Expander label="queries" increment="10"/>
        <Expander label="boundaries" increment=".1"/>
        <LocalStrategy label="DecoupledPRM-local2"/>
        <LocalStrategy label="CompositePRM-local"/>
      </ARCStrategy>

    </MPStrategies>


    <RepairStrategies>
      <LocalRepair label="localRepair1" windowSize="10" increment="1"
        radius="1.1"
        strategyLabel="CompositePRM-local" debug="false" vcLabel="local" behavior=""
        ifExpandRobot="false" probabilityDiscount="0.8" iterationEval="IterationEval2" ifHierarchical="true">
        <Expander label="queries" increment="10"/>
        <Expander label="boundaries" increment=".1"/>
        <!-- <LocalStrategy label="DecoupledPRM-local"/>
        <LocalStrategy label="DecoupledPRM-local2"/>
        <LocalStrategy label="CBSPRM-local"/> -->
        <LocalStrategy label="CompositePRM-local"/>
      </LocalRepair>
      <LocalRepair label="localRepair2" windowSize="10" increment="2"
        radius="1.1"
        strategyLabel="DecoupledPRM-local2" debug="true" vcLabel="local" behavior=""
        ifExpandRobot="false" probabilityDiscount="0.8" iterationEval="IterationEval2" ifHierarchical="true">
        <Expander label="queries" increment="10"/>
        <Expander label="boundaries" increment=".1"/>
        <LocalStrategy label="DecoupledPRM-local2"/>
        <LocalStrategy label="CompositePRM-local"/>
      </LocalRepair>          
      <LocalRepair label="localRepair3" windowSize="20" increment="2"
        radius="1.1"
        strategyLabel="CompositePRM-local" debug="false" vcLabel="local" behavior=""
        ifExpandRobot="false" probabilityDiscount="0.8" iterationEval="IterationEval2" ifHierarchical="true">
        <Expander label="queries" increment="10"/>
        <Expander label="boundaries" increment=".1"/>
        <!-- <LocalStrategy label="DecoupledPRM-local"/>
        <LocalStrategy label="DecoupledPRM-local2"/>
        <LocalStrategy label="CBSPRM-local"/> -->
        <LocalStrategy label="CompositePRM-local"/>
      </LocalRepair>
    </RepairStrategies>

    <MPTools>
      <SafeIntervalTool label="SI" vcLabel="pqp_solid" debug="false"/>
    </MPTools>

    <!-- MPProblem allows multiple solvers to be specified and executed. -->

    <Solver mpStrategyLabel="ARC" seed="15526"
      baseFilename="arc" vizmoDebug="false"/>

  </Library>

</MotionPlanning>
