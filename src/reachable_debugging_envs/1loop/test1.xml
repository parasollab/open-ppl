<?xml version='1.0' encoding='UTF-8'?>
<motion_planning>
  <MPProblem> 

    <environment input_env="chain.tree.env">
      <robot Cfg_name="cfg_reach_cc" num_joints="6" pos_dof="3" dofs="12">
        <boundary type="bbox" translational_scale="1">
          <parameter id="0" Label="x" type="translational" min="-15" max="15" />
          <parameter id="1" Label="y" type="translational" min="-10" max="10" />
          <parameter id="2" Label="z" type="translational" min="-15" max="15" />
        </boundary>
      </robot>
      <!-- <resolution pos_res="0.05" ori_res="0.05" / let the MP compute it-->
    </environment>


    
  
    <distance_metrics>
      <scaledEuclidean scale="0.9"/>
      <scaledEuclidean scale="0.9"/>
    </distance_metrics>

      
    <validity_test>  <!-- (cd1 & cd2) || !(cd2 || cd3)-->    
      <CollisionDetection Label="cd1" method="RAPID" />
      <CollisionDetection Label="cd2" method="PQP" />
      <CollisionDetection Label="cd3" method="VCLIP" />
      <!--JointLimit Label="jl" min="0.1" max="1.0"/-->      
      <ComposeValidity Label="com1" operator="and">
	      <vc_method method="cd1" />
	      <vc_method method="cd2" />
      </ComposeValidity>
      <ComposeValidity Label="com2" operator="or">
		    <vc_method method="cd2" />
		    <vc_method method="cd3" />
      </ComposeValidity>
      <NegateValidity Label ="notcom2" method ="com2" />
      <ComposeValidity Label="com3" operator="or">
	      <vc_method method="com1" />
	      <vc_method method="com2" />
      </ComposeValidity>      
    </validity_test>
    <NeighborhoodFinder>
      <BFNF Label="BFNF"/>
      <BandsNF Label="RbandClosestNF2k" debug="false">
          <RBand max = '32' k='16' policy='closest'/>        
      </BandsNF>
      <BandsNF Label="RbandRandomNF2k" debug="false">
          <RBand max = '32' k='16' policy='random'/>
      </BandsNF>
      <BandsNF Label="RbandClosestNF4k" debug="false">
          <RBand max = '64' k='16' policy='closest'/>
      </BandsNF>
      <BandsNF Label="RbandRandomNF4k" debug="false">
          <RBand max = '64' k='16' policy='random'/>
      </BandsNF>
      <BandsNF Label="RbandNF_2bands_2k" debug="false">
          <RBand max = '8' k='8' policy='closest'/>
          <RBand min = '8' max = '32' k='8' policy='random'/>
      </BandsNF>
      <BandsNF Label="RbandNF_2bands_4k" debug="false">
          <RBand max = '8' k='8' policy='closest'/>
          <RBand min = '8' max = '64' k='8' policy='random'/>
      </BandsNF>
      <BandsNF Label="random_k_nf" debug="false">
          <RBand max = '1000' k='16' policy='random'/>
      </BandsNF>

      <BandsNF Label="DbandNF" debug="false">
        <DBand max='1' k='16' policy='closest' />
      </BandsNF>
   </NeighborhoodFinder>
    <MPRegions/>
  </MPProblem>
  
  <MPStrategy>  
    <node_generation_methods>
      
      <UniformRandomFreeSampler Label="UniformRandomFree" vc_method="cd1" filename = "chain.tree"/>
      
      <ObstacleBasedSampler Label="ObstacleBased" vc_method="cd1">
	      <num_nodes number="100" exact="1"/>
	      <shells number="1"/>
	      <n_shells_coll number="0"/>
	      <n_shells_free number="1"/>
      </ObstacleBasedSampler> 
      <FreeMedialAxisSampler Label="FreeMedialAxis" vc_method="cd1">
	      <num_nodes number="100" exact="1"/>
	      <clearance number="10"/>
	      <penetration number="10"/>
      </FreeMedialAxisSampler> 
      <BridgeTestRandomFreeSampler Label="BridgeTestRandomFree"  vc_method="cd1">
        <bridge_d number=".1"/>
      </BridgeTestRandomFreeSampler>
    </node_generation_methods>
      
    <connection_methods>
      <NeighborhoodConnection Label="KClosest" nf="BFNF" k="16" CheckIfSameCC="false" />      
      <NeighborhoodConnection Label="AllPairs" nf="BFNF" k="1002" CheckIfSameCC="false" />  
      <NeighborhoodConnection Label="RbandRandom" nf="RbandRandomNF" k="16" CheckIfSameCC="false" />
      <NeighborhoodConnection Label="RbandClosest" nf="RbandClosestNF" k="16" CheckIfSameCC="false" />.
      <NeighborhoodConnection Label="Dband" nf="DbandNF" k="16" CheckIfSameCC="false" />
      <NeighborhoodConnection Label="RbandRandom2k" nf="RbandRandomNF2k" k="16" CheckIfSameCC="false" />
      <NeighborhoodConnection Label="RbandRandom4k" nf="RbandRandomNF4k" k="16" CheckIfSameCC="false" />
      <NeighborhoodConnection Label="Rband_2bands_2k" nf="RbandNF_2bands_2k" k="16" CheckIfSameCC="false" />
      <NeighborhoodConnection Label="Rband_2bands_4k" nf="RbandNF_2bands_4k" k="16" CheckIfSameCC="false" />
      <NeighborhoodConnection Label="RbandClosest_2_bands" nf="RbandClosestNF2_bands" k="16" CheckIfSameCC="false" />
      <NeighborhoodConnection Label="Random_k" nf="random_k_nf" k="16" CheckIfSameCC="false" />
    </connection_methods>

    <lp_methods>
      <straightline Label="sl" length="0" binary_search="1" vc_method="cd1"/>
    </lp_methods>
    
    <MPEvaluator_methods> <!-- MPStrategy constructor: done -->
      <MPRegionComparers> <!-- MapEvaluator:ParseXMLComparers: done  -->
	      <ConnectableComponentComparer Label="ConnectableComponent" /> <!-- ConnectableComponentComparer:done -->
	      <RandomConnectComparer Label="RandomQuery" number_of_configurations="100"/>
     </MPRegionComparers> <!-- MapEvaluator: -->
    </MPEvaluator_methods>
    
    <MPCharacterizer>
      <LocalNodeInfoCharacterizer Label="LocalNodeInfo" radius="2"/>
    </MPCharacterizer>
    
    <MPStrategyMethod Controller="PRM1">
      <BandsIncrementalRoadmap Label="PRM1" iterations="1" filename="test"
                query_filename="1loop.query" seed="111111" num_samples="1000">
              <node_generation_method Method="UniformRandomFree"/>
              <node_connection_method Method="Random_k"/>
              <!--><component_connection_method Method="ConnectCCs"/><-->
              <lp_method Method="sl"/>
      </BandsIncrementalRoadmap>
    </MPStrategyMethod>
  </MPStrategy>
</motion_planning>

